import { ObjectId } from "mongoose";
import Ted from "./Ted.js";
import { createTedMeta } from "./tedMeta.js";
import { logError, logTedSuccess, logUpdate } from "../util/logger.js";

const getData = async (count: number, startDate: string, endDate?: string) => {
  return await fetch("https://api.ted.europa.eu/v3/notices/search", {
    headers: {
      "Content-Type": "application/json",
    },
    method: "POST",
    body: JSON.stringify({
      query: `(publication-date >=${startDate}<=${endDate})  AND (notice-type IN (can-standard can-social can-desg can-tran)) AND (place-of-performance IN (DEU)) AND (buyer-country IN (DEU)) SORT BY publication-date`,
      fields: [
        "BT-09(b)-Procedure",
        "organisation-name-mediator-part",
        "touchpoint-post-code-environ-legis-lot",
        "sme-part",
        "touchpoint-gateway-ted-esen",
        "BT-135-Procedure",
        "touchpoint-fax-tender-receip-part",
        "submission-url-lot",
        "organisation-person-addinfo-part",
        "buyer-country-sub",
        "organisation-tel-revieworg-part",
        "no-negocaition-necessary-lot",
        "organisation-tel-mediator-lot",
        "BT-13(t)-Part",
        "organisation-city-serv-prov",
        "touchpoint-partname-tenderer",
        "touchpoint-internet-address-paying",
        "BT-538-Lot",
        "touchpoint-post-code-addinfo-lot",
        "BT-24-Procedure",
        "option-description-lot",
        "winne-identifier",
        "organisation-person-employ-legis-part",
        "touchpoint-post-code-employ-legis-part",
        "AA",
        "AC",
        "touchpoint-internet-address-fiscal-legis-lot",
        "organisation-email-tenderer",
        "organisation-country-buyer",
        "award-criterion-name-lot",
        "organisation-post-code-docprovider-part",
        "organisation-post-code-financing",
        "touchpoint-contact-point-addinfo-lot",
        "BT-137-Part",
        "organisation-person-mediator-lot",
        "AU",
        "organisation-gateway-revieworg-lot",
        "organisation-person-signatory",
        "minimum-candidate-lot",
        "OPP-130-Business",
        "organisation-name-employ-legis-part",
        "organisation-street-ted-esen",
        "touchpoint-city-fiscal-legis-lot",
        "touchpoint-street-employ-legis-part",
        "touchpoint-email-revieworg-lot",
        "business-fax",
        "future-notice",
        "touchpoint-gateway-environ-legis-part",
        "OPP-021-Contract",
        "BI",
        "BT-33-Procedure",
        "touchpoint-tel-subcontractor",
        "ubo-email",
        "touchpoint-internet-address-tender-receip-part",
        "touchpoint-internet-address-tender-eval-part",
        "organisation-person-environ-legis-lot",
        "touchpoint-partname-tender-eval-part",
        "organisation-tel-addinfo-part",
        "BT-5131-Part",
        "BT-1501(n)-Contract",
        "touchpoint-contact-point-fiscal-legis-part",
        "organisation-contact-point-serv-prov",
        "BT-712(b)-LotResult",
        "touchpoint-country-serv-prov",
        "touchpoint-contact-point-tender-eval-part",
        "touchpoint-contact-point-reviewinfo-part",
        "electronic-auction-lot-url",
        "touchpoint-fax-buyer",
        "deadline-date-lot",
        "organisation-name-environ-legis-lot",
        "subcontracting-value-cur",
        "description-glo",
        "organisation-person-employ-legis-lot",
        "organisation-country-docprovider-lot",
        "winner-owner-nationality",
        "tender-value-cur",
        "touchpoint-city-revieworg-lot",
        "award-criterion-number-fixed-glo",
        "BT-732-Lot",
        "organisation-partname-docprovider-part",
        "touchpoint-name-docprovider-lot",
        "touchpoint-internet-address-subcontractor",
        "CY",
        "BT-727-Part",
        "place-of-performance-post-code-part",
        "BT-651-Lot",
        "BT-150-Contract",
        "BT-45-Lot",
        "BT-710-LotResult",
        "DD",
        "organisation-internet-address-addinfo-lot",
        "deadline-receipt-tender-date-lot",
        "organisation-email-mediator-lot",
        "identifier-part",
        "DI",
        "BT-1311(t)-Lot",
        "touchpoint-city-reviewinfo-lot",
        "BT-46-Lot",
        "modification-justification",
        "tender-variant",
        "BT-70-Lot",
        "touchpoint-country-revieworg-lot",
        "touchpoint-country-employ-legis-lot",
        "DS",
        "DT",
        "BT-707-Lot",
        "touchpoint-name-subcontractor",
        "touchpoint-partname-financing",
        "BT-52-Lot",
        "buyer-reviewrequests-irregularity-type",
        "touchpoint-country-reviewinfo-lot",
        "contract-nature-add-part",
        "organisation-person-tender-eval-lot",
        "lots-max-allowed-proc",
        "touchpoint-partname-fiscal-legis-lot",
        "organisation-city-signatory",
        "internal-identifier-glo",
        "BT-99-Lot",
        "contract-identifier",
        "organisation-country-sub-subcontractor",
        "BT-539-Lot",
        "organisation-country-sub-docprovider-part",
        "organisation-post-code-fiscal-legis-lot",
        "touchpoint-street-tender-eval-part",
        "organisation-internet-address-ted-esen",
        "BT-733-LotsGroup",
        "BT-36-Lot",
        "touchpoint-country-sub-financing",
        "BT-118-NoticeResult",
        "organisation-email-subcontractor",
        "BT-134-Lot",
        "organisation-tel-employ-legis-part",
        "touchpoint-street-subcontractor",
        "corporate-body",
        "touchpoint-country-reviewinfo-part",
        "touchpoint-city-docprovider-part",
        "buyer-touchpoint-gateway",
        "BT-709-LotResult",
        "procurement-relaunch",
        "maximum-candidates-lot",
        "touchpoint-name-fiscal-legis-part",
        "place-of-performance-city-lot",
        "BT-22-LotsGroup",
        "FT",
        "organisation-internet-address-docprovider-part",
        "organisation-tel-buyer",
        "BT-5141-Lot",
        "touchpoint-tel-tender-receip-lot",
        "previous-planning-identifier-part-lot",
        "BT-5121-Procedure",
        "touchpoint-fax-environ-legis-part",
        "organisation-email-fiscal-legis-part",
        "BT-13713-LotResult",
        "contract-nature-main-proc",
        "organisation-country-tenderer",
        "tool-url-part",
        "touchpoint-street-revieworg-part",
        "organisation-email-addinfo-part",
        "organisation-tel-signatory",
        "touchpoint-street-tender-receip-part",
        "touchpoint-street-environ-legis-lot",
        "organisation-country-sub-docprovider-lot",
        "organisation-contact-point-signatory",
        "missing-info-submission-description-lot",
        "organisation-identifier-signatory",
        "touchpoint-city-tender-eval-part",
        "touchpoint-fax-environ-legis-lot",
        "organisation-post-code-tender-eval-lot",
        "BT-708-Lot",
        "organisation-name-tender-receip-lot",
        "change-previous-notice-section-identifier",
        "jury-member-name-lot",
        "organisation-contact-point-tenderer",
        "organisation-internet-address-fiscal-legis-lot",
        "ubo-fax",
        "quality-target-description-lot",
        "HA",
        "OPT-150-LOT",
        "touchpoint-internet-address-reviewinfo-part",
        "touchpoint-country-mediator-part",
        "touchpoint-country-signatory",
        "predominance-lot",
        "reserved-execution-lot",
        "BT-636-LotResult",
        "touchpoint-tel-employ-legis-lot",
        "buyer-review-compainants-code",
        "organisation-contact-point-fiscal-legis-part",
        "contract-framework-agreement",
        "selection-criterion-description-lot",
        "touchpoint-city-buyer",
        "variant-allowed-lot",
        "additional-classification-proc",
        "place-of-performance-country-proc",
        "BT-768-Contract",
        "touchpoint-fax-paying",
        "framework-agreement-part",
        "place-of-performance-post-code-proc",
        "touchpoint-fax-addinfo-part",
        "touchpoint-internet-address-ted-esen",
        "IA",
        "buyer-gateway",
        "BT-47-Lot",
        "organisation-fax-tender-eval-part",
        "contract-duration-end-date-lot",
        "ubo-street",
        "jury-decision-binding-lot",
        "BT-5423-LotsGroup",
        "BT-635-LotResult",
        "OPP-123-Business",
        "BT-777-Lot",
        "touchpoint-gateway-fiscal-legis-part",
        "framework-agreement-lot",
        "BT-734-Lot",
        "organisation-street-mediator-part",
        "touchpoint-email-ted-esen",
        "document-restricted-part",
        "selection-criteria-second-stage-invite-lot",
        "touchpoint-email-tender-receip-lot",
        "touchpoint-city-addinfo-part",
        "BT-98-Lot",
        "BT-19-Lot",
        "BT-726-Part",
        "direct-award-justification-previous-procedure-identifier-proct",
        "BT-1252-Procedure",
        "organisation-email-reviewinfo-part",
        "BT-127-notice",
        "organisation-city-addinfo-part",
        "organisation-person-tender-eval-part",
        "touchpoint-tel-financing",
        "BT-610-Procedure-Buyer",
        "BT-01(c)-procedure",
        "organisation-country-tender-eval-part",
        "BT-132(d)-Lot",
        "winner-post-code",
        "organisation-country-reviewinfo-lot",
        "organisation-partname-docprovider-lot",
        "change-procurement-documents",
        "touchpoint-street-fiscal-legis-lot",
        "touchpoint-email-docprovider-lot",
        "buyer-touchpoint-partname",
        "BT-5422-LotsGroup",
        "registration-date",
        "organisation-person-tender-receip-part",
        "touchpoint-gateway-mediator-lot",
        "BT-01-notice",
        "BT-27-Part",
        "touchpoint-street-serv-prov",
        "framework-estimated-value-glo",
        "organisation-name-addinfo-lot",
        "organisation-post-code-mediator-lot",
        "touchpoint-internet-address-docprovider-part",
        "touchpoint-name-environ-legis-lot",
        "organisation-partname-revieworg-part",
        "touchpoint-internet-address-addinfo-lot",
        "organisation-identifier-docprovider-lot",
        "publication-date",
        "selection-criterion-name-lot",
        "BT-736-Part",
        "BT-554-Tender",
        "business-email",
        "buyer-email",
        "legal-basis-text",
        "OPP-011-notice",
        "subcontracting-percentage",
        "vehicule-type",
        "subcontracting-allowed-lot",
        "BT-05(a)-notice",
        "organisation-email-paying",
        "BT-5131-Lot",
        "touchpoint-street-tender-receip-lot",
        "modification-previous-notice-identifier",
        "BT-769-Lot",
        "touchpoint-country-tender-eval-lot",
        "organisation-partname-addinfo-lot",
        "significance-lot",
        "touchpoint-street-docprovider-part",
        "organisation-identifier-tenderer",
        "BT-726-Lot",
        "touchpoint-city-tenderer",
        "touchpoint-street-environ-legis-part",
        "touchpoint-tel-reviewinfo-part",
        "award-criterion-number-weight-glo",
        "touchpoint-contact-point-buyer",
        "touchpoint-post-code-reviewinfo-lot",
        "contract-nature-add-proc",
        "touchpoint-country-sub-docprovider-lot",
        "estimated-value-glo",
        "buyer-touchpoint-post-code",
        "tender-rank",
        "organisation-post-code-tenderer",
        "BT-634-Lot",
        "tool-name-part",
        "buyer-profile",
        "organisation-name-reviewinfo-part",
        "winner-country",
        "touchpoint-city-mediator-part",
        "touchpoint-partname-addinfo-lot",
        "winner-country-sub",
        "requirement-stage-lot",
        "deadline-time-part",
        "MA",
        "organisation-country-sub-mediator-lot",
        "organisation-fax-fiscal-legis-lot",
        "touchpoint-contact-point-revieworg-lot",
        "BT-88-Procedure",
        "touchpoint-email-tender-eval-lot",
        "ojs-number",
        "BT-632-Lot",
        "BT-733-Lot",
        "links",
        "organisation-person-financing",
        "organisation-post-code-revieworg-part",
        "business-city",
        "BT-54-lot",
        "organisation-person-environ-legis-part",
        "organisation-tel-docprovider-lot",
        "organisation-fax-revieworg-part",
        "organisation-tel-mediator-part",
        "touchpoint-tel-buyer",
        "BT-728-Part",
        "place-of-performance-country-part",
        "organisation-person-serv-prov",
        "organisation-name-serv-prov",
        "organisation-post-code-signatory",
        "touchpoint-fax-docprovider-part",
        "touchpoint-street-reviewinfo-part",
        "BT-60-Lot",
        "renewal-maximum-lot",
        "touchpoint-internet-address-revieworg-part",
        "BT-13716-notice",
        "organisation-name-revieworg-lot",
        "touchpoint-gateway-tender-eval-part",
        "BT-21-Procedure",
        "deadline-receipt-request-time-lot",
        "identifier-glo",
        "ubo-country",
        "gpa-lot",
        "organisation-street-revieworg-lot",
        "NC",
        "touchpoint-fax-employ-legis-part",
        "organisation-name-financing",
        "ND",
        "touchpoint-internet-address-tender-eval-lot",
        "touchpoint-country-sub-employ-legis-part",
        "BT-97-Lot",
        "NL",
        "accessibility-justification-lot",
        "security-clearence-deadline-lot",
        "title-part",
        "touchpoint-street-addinfo-part",
        "touchpoint-tel-employ-legis-part",
        "deadline-receipt-expressions-time-lot",
        "BT-05(b)-notice",
        "touchpoint-fax-fiscal-legis-lot",
        "organisation-fax-mediator-lot",
        "organisation-person-tender-receip-lot",
        "organisation-partname-tender-eval-lot",
        "touchpoint-tel-paying",
        "winner-touchpoint-gateway",
        "organisation-country-sub-employ-legis-part",
        "touchpoint-gateway-subcontractor",
        "OJ",
        "OPP-105-Business",
        "eu-funds-name",
        "OL",
        "organisation-fax-fiscal-legis-part",
        "organisation-fax-tenderer",
        "business-identifier",
        "place-of-performance",
        "public-opening-place-lot",
        "organisation-email-signatory",
        "organisation-contact-point-financing",
        "tender-value-cur-highest",
        "organisation-fax-addinfo-lot",
        "touchpoint-country-ted-esen",
        "BT-776-Lot",
        "touchpoint-contact-point-docprovider-part",
        "buyer-legal-type",
        "organisation-city-tender-receip-part",
        "BT-27-Lot",
        "touchpoint-contact-point-fiscal-legis-lot",
        "additional-classification-part",
        "touchpoint-city-docprovider-lot",
        "PC",
        "organisation-fax-serv-prov",
        "organisation-fax-buyer",
        "PD",
        "organisation-country-revieworg-lot",
        "organisation-country-fiscal-legis-lot",
        "organisation-tel-environ-legis-lot",
        "touchpoint-gateway-fiscal-legis-lot",
        "BT-615-Part",
        "organisation-country-docprovider-part",
        "touchpoint-gateway-docprovider-part",
        "organisation-tel-tender-eval-lot",
        "BT-727-Lot",
        "BT-11-Procedure-Buyer",
        "touchpoint-street-buyer",
        "change-reason-code",
        "organisation-gateway-ted-esen",
        "recurrence-lot",
        "BT-727-Procedure",
        "PR",
        "contract-conclusion-date",
        "subcontracting-percentage-ind",
        "change-description",
        "place-of-performance-city-part",
        "touchpoint-street-paying",
        "organisation-country-addinfo-part",
        "strategic-procurement-description-lot",
        "touchpoint-partname-fiscal-legis-part",
        "organisation-identifier-mediator-lot",
        "BT-543-LotsGroup",
        "BT-24-Part",
        "BT-767-Lot",
        "electronic-signature-lot",
        "organisation-email-employ-legis-part",
        "OPP-023-Contract",
        "organisation-fax-employ-legis-part",
        "subcontracting-obligation-lot",
        "organisation-person-reviewinfo-part",
        "subcontracting-description",
        "touchpoint-country-sub-revieworg-lot",
        "submission-nonelectronic-lot",
        "touchpoint-country-sub-tender-eval-part",
        "touchpoint-partname-reviewinfo-part",
        "organisation-email-environ-legis-lot",
        "organisation-fax-environ-legis-lot",
        "title-proc",
        "organisation-contact-point-employ-legis-lot",
        "organisation-identifier-financing",
        "touchpoint-contact-point-tenderer",
        "award-criterion-number-weight-lot",
        "BT-737-Part",
        "eu-registration-number",
        "RC",
        "organisation-tel-docprovider-part",
        "touchpoint-contact-point-paying",
        "public-opening-date-lot",
        "touchpoint-internet-address-mediator-lot",
        "touchpoint-city-employ-legis-lot",
        "touchpoint-internet-address-reviewinfo-lot",
        "RN",
        "RP",
        "organisation-country-sub-addinfo-lot",
        "touchpoint-partname-docprovider-lot",
        "contract-duration-period-oth-part",
        "organisation-city-docprovider-part",
        "organisation-country-mediator-part",
        "organisation-contact-point-mediator-lot",
        "organisation-fax-reviewinfo-part",
        "registration-place-postcode",
        "touchpoint-email-serv-prov",
        "BT-630(t)-Lot",
        "touchpoint-country-paying",
        "touchpoint-post-code-tender-eval-part",
        "concession-revenue-buyer",
        "touchpoint-fax-tender-eval-part",
        "renewal-description-lot",
        "organisation-internet-address-tender-receip-lot",
        "BT-124-Lot",
        "BT-751-Lot",
        "touchpoint-tel-addinfo-part",
        "registration-place-town",
        "BT-13(d)-Part",
        "organisation-name-docprovider-part",
        "organisation-contact-point-reviewinfo-part",
        "organisation-post-code-mediator-part",
        "deadline-receipt-request",
        "BT-136-Procedure",
        "BT-140-notice",
        "touchpoint-country-sub-subcontractor",
        "organisation-country-serv-prov",
        "organisation-street-tender-receip-part",
        "touchpoint-partname-tender-receip-part",
        "touchpoint-tel-signatory",
        "organisation-street-revieworg-part",
        "BT-64-Lot",
        "BT-708-Part",
        "organisation-post-code-addinfo-lot",
        "revenues-allocation-lot",
        "organisation-country-sub-tender-eval-lot",
        "touchpoint-street-tender-eval-lot",
        "TD",
        "document-restricted-url-lot",
        "touchpoint-street-addinfo-lot",
        "place-of-performance-country-lot",
        "contract-duration-start-date-part",
        "organisation-internet-address-revieworg-part",
        "classification-cpv",
        "TI",
        "BT-23-Procedure",
        "touchpoint-street-fiscal-legis-part",
        "ecatalog-allowed-lot",
        "organisation-city-environ-legis-part",
        "organisation-gateway-addinfo-lot",
        "BT-508-Procedure-Buyer",
        "BT-632-Part",
        "TV",
        "TW",
        "touchpoint-gateway-reviewinfo-part",
        "TY",
        "csecurity-clearance-description-lot",
        "touchpoint-contact-point-tender-receip-part",
        "multiple-tender-lot",
        "organisation-person-fiscal-legis-lot",
        "organisation-tel-ted-esen",
        "BT-5421-Lot",
        "organisation-partname-employ-legis-lot",
        "organisation-tel-tender-receip-lot",
        "change-reason-description",
        "organisation-fax-paying",
        "BT-141(a)-notice",
        "additional-info-proc",
        "touchpoint-name-employ-legis-part",
        "touchpoint-partname-addinfo-part",
        "BT-95-Lot",
        "dps-usage-lot",
        "place-of-performance-other-lot",
        "BT-202-Contract",
        "touchpoint-country-sub-paying",
        "BT-21-LotsGroup",
        "OPT-155-LotResult",
        "organisation-country-sub-environ-legis-part",
        "BT-79-Lot",
        "direct-award-justification-proc",
        "touchpoint-city-tender-receip-lot",
        "touchpoint-country-sub-serv-prov",
        "organisation-internet-address-tender-eval-lot",
        "organisation-person-docprovider-lot",
        "organisation-post-code-ted-esen",
        "competition-termination-proc",
        "contract-conditions-code-lot",
        "touchpoint-country-sub-reviewinfo-lot",
        "BT-15-Part",
        "BT-758-notice",
        "cross-border-law-identifier-proc",
        "organisation-person-fiscal-legis-part",
        "touchpoint-country-tender-eval-part",
        "result-value-notice",
        "BT-736-Lot",
        "ubo-city",
        "organisation-contact-point-revieworg-part",
        "BT-752-Lot",
        "framework-value-cur-notice",
        "touchpoint-country-tenderer",
        "organisation-post-code-revieworg-lot",
        "BT-133-Lot",
        "organisation-country-signatory",
        "organisation-country-paying",
        "touchpoint-post-code-revieworg-part",
        "organisation-partname-signatory",
        "procedure-justification",
        "touchpoint-internet-address-addinfo-part",
        "official-language",
        "BT-756-Procedure",
        "eu-fund-lot",
        "BT-03-notice",
        "touchpoint-name-signatory",
        "winner-touchpoint-post-code",
        "contract-duration-end-date-part",
        "BT-123-Lot",
        "touchpoint-post-code-fiscal-legis-lot",
        "TV_CUR",
        "touchpoint-post-code-tenderer",
        "innovative-acquisition-lot",
        "organisation-identifier-revieworg-lot",
        "organisation-country-environ-legis-part",
        "BT-67(b)-Procedure",
        "touchpoint-partname-mediator-lot",
        "deadline-receipt-expressions-date-lot",
        "touchpoint-internet-address-buyer",
        "BT-145-Contract",
        "touchpoint-email-buyer",
        "organisation-gateway-employ-legis-lot",
        "touchpoint-country-fiscal-legis-lot",
        "document-restricted-lot",
        "touchpoint-street-financing",
        "BT-27-LotsGroup",
        "framework-maximum-participants-number-lot",
        "award-criteria-order-justification",
        "tool-atypical-url-lot",
        "organisation-street-mediator-lot",
        "organisation-internet-address-employ-legis-lot",
        "BT-5141-Procedure",
        "organisation-contact-point-docprovider-lot",
        "BT-63-Lot",
        "touchpoint-email-reviewinfo-lot",
        "touchpoint-partname-revieworg-part",
        "organisation-fax-docprovider-lot",
        "touchpoint-tel-mediator-lot",
        "OPP-032-Tender",
        "organisation-post-code-subcontractor",
        "BT-707-Part",
        "procedure-features",
        "touchpoint-country-mediator-lot",
        "BT-538-Part",
        "touchpoint-post-code-tender-receip-lot",
        "BT-105-Procedure",
        "BT-765-Lot",
        "organisation-city-reviewinfo-lot",
        "organisation-gateway-environ-legis-part",
        "organisation-identifier-paying",
        "organisation-street-addinfo-lot",
        "assets-related-contract-extension-indicator-lot",
        "BT-137-Lot",
        "business-country-sub",
        "security-clearance-lot",
        "organisation-identifier-addinfo-lot",
        "touchpoint-name-paying",
        "organisation-post-code-tender-eval-part",
        "touchpoint-country-sub-tender-receip-part",
        "organisation-name-signatory",
        "touchpoint-gateway-addinfo-part",
        "touchpoint-name-tender-eval-part",
        "touchpoint-partname-employ-legis-lot",
        "BT-660-LotResult",
        "organisation-country-sub-fiscal-legis-part",
        "touchpoint-partname-reviewinfo-lot",
        "touchpoint-contact-point-tender-eval-lot",
        "touchpoint-fax-addinfo-lot",
        "BT-122-Lot",
        "organisation-city-fiscal-legis-part",
        "touchpoint-country-tender-receip-lot",
        "organisation-contact-point-employ-legis-part",
        "organisation-email-environ-legis-part",
        "touchpoint-gateway-docprovider-lot",
        "BT-501-Business-European",
        "organisation-fax-subcontractor",
        "BT-262-Lot",
        "OPP-040-Procedure",
        "BT-5422-Lot",
        "organisation-person-tenderer",
        "touchpoint-city-signatory",
        "organisation-country-sub-buyer",
        "buyer-touchpoint-city",
        "BT-24-Lot",
        "main-classification-lot",
        "touchpoint-city-financing",
        "organisation-partname-fiscal-legis-part",
        "touchpoint-contact-point-addinfo-part",
        "BT-109-Lot",
        "organisation-gateway-employ-legis-part",
        "organisation-street-tender-eval-lot",
        "touchpoint-partname-serv-prov",
        "BT-21-Part",
        "organisation-internet-address-mediator-lot",
        "organisation-tel-paying",
        "organisation-identifier-mediator-part",
        "organisation-partname-ted-esen",
        "buyer-touchpoint-contact-point",
        "organisation-street-reviewinfo-part",
        "dispatch-time",
        "organisation-internet-address-mediator-part",
        "organisation-partname-reviewinfo-part",
        "organisation-street-fiscal-legis-part",
        "BT-701-notice",
        "organisation-identifier-environ-legis-lot",
        "organisation-identifier-serv-prov",
        "BT-157-LotsGroup",
        "BT-737-Lot",
        "organisation-email-mediator-part",
        "touchpoint-city-addinfo-lot",
        "touchpoint-city-mediator-lot",
        "business-tel",
        "organisation-city-buyer",
        "organisation-fax-tender-eval-lot",
        "organisation-gateway-environ-legis-lot",
        "organisation-name-revieworg-part",
        "organisation-gateway-paying",
        "funding",
        "issue-date",
        "BT-51-Lot",
        "touchpoint-tel-fiscal-legis-lot",
        "business-contact-point",
        "touchpoint-street-employ-legis-lot",
        "contract-nature-add-lot",
        "BT-106-Procedure",
        "estimated-value-cur-proc",
        "BT-94-Lot",
        "buyer-person",
        "quality-target-code-lot",
        "organisation-fax-revieworg-lot",
        "OPP-121-Business",
        "BT-536-Lot",
        "touchpoint-country-sub-tenderer",
        "touchpoint-fax-tender-receip-lot",
        "organisation-internet-address-tender-receip-part",
        "OPP-030-Tender",
        "BT-163-Tender",
        "submission-nonelectronic-description-lot",
        "touchpoint-internet-address-employ-legis-lot",
        "additional-information-lot",
        "BT-27-Procedure",
        "BT-766-Lot",
        "organisation-internet-address-subcontractor",
        "BT-537-Lot",
        "winner-gateway",
        "organisation-city-revieworg-part",
        "BT-722-Contract",
        "touchpoint-city-reviewinfo-part",
        "result-value-lot",
        "touchpoint-country-sub-fiscal-legis-lot",
        "organisation-contact-point-addinfo-part",
        "organisation-tel-environ-legis-part",
        "kilometer-public-transport",
        "authority-main-activity",
        "title-glo",
        "OPP-080-Tender",
        "winner-person",
        "organisation-country-sub-signatory",
        "organisation-country-ted-esen",
        "BT-263-Lot",
        "touchpoint-street-ted-esen",
        "touchpoint-name-environ-legis-part",
        "organisation-gateway-mediator-part",
        "selection-criterion-used-lot",
        "BT-5071-Part",
        "estimated-value-cur-lot",
        "touchpoint-street-signatory",
        "organisation-country-employ-legis-part",
        "organisation-post-code-reviewinfo-part",
        "organisation-internet-address-docprovider-lot",
        "BT-191-Tender",
        "BT-5423-Lot",
        "concession-value-description",
        "organisation-identifier-environ-legis-part",
        "subcontracting-obligation-minimum-lot",
        "touchpoint-fax-mediator-lot",
        "organisation-fax-environ-legis-part",
        "accessibility-lot",
        "BT-23-Lot",
        "organisation-post-code-serv-prov",
        "BT-531-Part",
        "electronic-submission-lot",
        "notice-version",
        "BT-5121-Lot",
        "subcontracting-indication-lot",
        "organisation-identifier-revieworg-part",
        "touchpoint-internet-address-environ-legis-lot",
        "award-criterion-number-threshold-lot",
        "document-restricted-justification",
        "touchpoint-name-mediator-part",
        "organisation-fax-mediator-part",
        "touchpoint-fax-ted-esen",
        "touchpoint-name-ted-esen",
        "touchpoint-tel-tenderer",
        "touchpoint-email-tender-eval-part",
        "organisation-post-code-fiscal-legis-part",
        "organisation-post-code-environ-legis-part",
        "award-criterion-type-glo",
        "winner-email",
        "organisation-street-paying",
        "place-of-performance-post-code-lot",
        "ubo-name",
        "estimated-value-cur-part",
        "BT-22-Lot",
        "BT-1351-Procedure",
        "organisation-fax-employ-legis-lot",
        "organisation-identifier-docprovider-part",
        "buyer-post-code",
        "BT-65-Lot",
        "touchpoint-email-fiscal-legis-lot",
        "framework-estimated-value-cur-glo",
        "OPP-111-Business",
        "touchpoint-tel-tender-eval-part",
        "organisation-city-financing",
        "BT-750-Lot",
        "winner-touchpoint-partname",
        "organisation-city-tenderer",
        "organisation-country-sub-paying",
        "touchpoint-tel-fiscal-legis-part",
        "organisation-name-tender-receip-part",
        "lots-all-required-proc",
        "organisation-internet-address-revieworg-lot",
        "touchpoint-email-paying",
        "touchpoint-name-fiscal-legis-lot",
        "tender-value",
        "BT-50-Lot",
        "BT-93-Lot",
        "organisation-partname-financing",
        "document-official-language-lot",
        "organisation-country-financing",
        "touchpoint-street-docprovider-lot",
        "organisation-name-reviewinfo-lot",
        "touchpoint-email-signatory",
        "organisation-gateway-financing",
        "organisation-identifier-addinfo-part",
        "submission-language",
        "BT-762-notice",
        "organisation-identifier-buyer",
        "additional-info-part",
        "touchpoint-gateway-paying",
        "touchpoint-gateway-employ-legis-lot",
        "BT-132(t)-Lot",
        "BT-31-Procedure",
        "winner-touchpoint-internet-address",
        "organisation-city-tender-receip-lot",
        "touchpoint-gateway-tender-eval-lot",
        "BT-10-Procedure-Buyer",
        "OPP-122-Business",
        "modification-description",
        "BT-120-Lot",
        "BT-759-LotResult",
        "touchpoint-contact-point-docprovider-lot",
        "organisation-street-reviewinfo-lot",
        "touchpoint-partname-environ-legis-lot",
        "organisation-gateway-subcontractor",
        "touchpoint-city-serv-prov",
        "organisation-contact-point-tender-receip-lot",
        "touchpoint-country-sub-revieworg-part",
        "dispatch-invitation-tender-lot",
        "touchpoint-name-revieworg-part",
        "organisation-post-code-tender-receip-part",
        "organisation-name-buyer",
        "organisation-street-financing",
        "BT-24-LotsGroup",
        "BT-13(d)-Lot",
        "organisation-contact-point-environ-legis-part",
        "touchpoint-email-addinfo-lot",
        "organisation-contact-point-buyer",
        "organisation-contact-point-tender-eval-lot",
        "BT-171-Tender",
        "organisation-internet-address-paying",
        "BT-747-Lot",
        "touchpoint-country-environ-legis-part",
        "business-post-code",
        "touchpoint-city-subcontractor",
        "touchpoint-tel-tender-receip-part",
        "BT-771-Lot",
        "touchpoint-country-environ-legis-lot",
        "BT-537-Part",
        "lots-max-awarded-proc",
        "organisation-city-employ-legis-lot",
        "announcement-title",
        "organisation-country-sub-serv-prov",
        "BT-06-Lot",
        "touchpoint-post-code-tender-receip-part",
        "organisation-person-revieworg-part",
        "additional-information",
        "organisation-country-sub-mediator-part",
        "winner-touchpoint-country",
        "organisation-identifier-tender-receip-lot",
        "organisation-identifier-tender-receip-part",
        "touchpoint-email-fiscal-legis-part",
        "BT-160-Tender",
        "BT-92-Lot",
        "winner-touchpoint-country-sub",
        "organisation-tel-employ-legis-lot",
        "BT-02-notice",
        "BT-161-NoticeResult",
        "organisation-gateway-tender-eval-part",
        "framework-estimated-value",
        "touchpoint-gateway-tender-receip-lot",
        "touchpoint-internet-address-revieworg-lot",
        "BT-531-Lot",
        "internal-identifier-part",
        "exclusion-grounds",
        "organisation-email-reviewinfo-lot",
        "winner-contact-point",
        "organisation-partname-tender-receip-lot",
        "estimated-value-proc",
        "touchpoint-email-environ-legis-part",
        "deadline",
        "description-part",
        "touchpoint-country-subcontractor",
        "touchpoint-tel-revieworg-lot",
        "touchpoint-country-sub-fiscal-legis-part",
        "place-of-performance-other-part",
        "BT-21-Lot",
        "touchpoint-city-paying",
        "touchpoint-name-revieworg-lot",
        "touchpoint-email-subcontractor",
        "BT-14-Part",
        "notice-purpose",
        "winner-size",
        "buyer-touchpoint-country-sub",
        "organisation-gateway-revieworg-part",
        "organisation-gateway-serv-prov",
        "organisation-street-tender-receip-lot",
        "result-value-cur-notice",
        "organisation-internet-address-tenderer",
        "reserved-execution-part",
        "BT-757-notice",
        "place-of-performance-additional-part",
        "BT-539-LotsGroup",
        "organisation-name-addinfo-part",
        "organisation-person-buyer",
        "touchpoint-internet-address-tender-receip-lot",
        "organisation-partname-serv-prov",
        "BT-263-Part",
        "touchpoint-name-serv-prov",
        "non-award-justification",
        "award-criterion-number-fixed-lot",
        "procedure-identifier",
        "touchpoint-internet-address-docprovider-lot",
        "touchpoint-email-tender-receip-part",
        "organisation-contact-point-fiscal-legis-lot",
        "gpa-part",
        "organisation-name-paying",
        "tool-name-lot",
        "touchpoint-partname-tender-eval-lot",
        "touchpoint-post-code-employ-legis-lot",
        "BT-111-Lot",
        "organisation-country-sub-revieworg-lot",
        "organisation-country-sub-ted-esen",
        "BT-578-Lot",
        "organisation-street-docprovider-lot",
        "BT-764-Lot",
        "group-framework-value-cur-notice",
        "touchpoint-contact-point-signatory",
        "ubo-country-sub",
        "identifier-lot",
        "organisation-name-employ-legis-lot",
        "BT-540-LotsGroup",
        "touchpoint-country-sub-mediator-lot",
        "OPP-012-notice",
        "place-of-performance-subdiv-lot",
        "subcontracting",
        "winner-touchpoint-contact-point",
        "estimated-value-lot",
        "procedure-accelerated",
        "award-criterion-type-lot",
        "touchpoint-country-sub-addinfo-part",
        "touchpoint-city-environ-legis-lot",
        "touchpoint-country-tender-receip-part",
        "BT-193-Tender",
        "description-lot",
        "organisation-country-sub-reviewinfo-part",
        "tender-value-highest",
        "organisation-email-employ-legis-lot",
        "organisation-city-mediator-part",
        "organisation-contact-point-mediator-part",
        "touchpoint-fax-tenderer",
        "touchpoint-name-buyer",
        "guarantee-required-description-lot",
        "organisation-gateway-signatory",
        "organisation-street-fiscal-legis-lot",
        "additional-classification-lot",
        "BT-5071-Procedure",
        "organisation-partname-addinfo-part",
        "organisation-name-tender-eval-part",
        "organisation-contact-point-docprovider-part",
        "organisation-identifier-reviewinfo-lot",
        "organisation-name-mediator-lot",
        "organisation-country-reviewinfo-part",
        "award-criterion-description-glo",
        "organisation-internet-address-reviewinfo-lot",
        "sme-lot",
        "organisation-partname-tender-receip-part",
        "touchpoint-name-tender-eval-lot",
        "BT-1375-Procedure",
        "organisation-street-tender-eval-part",
        "BT-728-Procedure",
        "touchpoint-post-code-serv-prov",
        "organisation-country-sub-reviewinfo-lot",
        "touchpoint-internet-address-mediator-part",
        "legal-basis",
        "OPP-113-Business-European",
        "touchpoint-country-docprovider-lot",
        "BT-719-notice",
        "organisation-gateway-docprovider-part",
        "buyer-country",
        "electronic-invoicing-lot",
        "BT-5421-LotsGroup",
        "BT-14-Lot",
        "OPP-020-Contract",
        "buyer-contracting-entity",
        "electronic-auction-description-lot",
        "award-criterion-order-justification-lot",
        "organisation-email-revieworg-lot",
        "organisation-street-tenderer",
        "procedure-type",
        "organisation-internet-address-addinfo-part",
        "organisation-internet-address-environ-legis-lot",
        "organisation-gateway-fiscal-legis-lot",
        "place-of-performance-other-proc",
        "recurrence-description-lot",
        "organisation-email-tender-eval-part",
        "touchpoint-gateway-employ-legis-part",
        "BT-749-Lot",
        "organisation-country-sub-financing",
        "touchpoint-contact-point-mediator-lot",
        "award-criterion-name-glo",
        "selection-criteria-second-stage-invite-number-lot",
        "organisation-identifier-employ-legis-lot",
        "BT-5131-Procedure",
        "touchpoint-gateway-buyer",
        "touchpoint-internet-address-signatory",
        "contract-duration-period-lot",
        "organisation-city-docprovider-lot",
        "organisation-identifier-subcontractor",
        "organisation-country-sub-employ-legis-lot",
        "organisation-internet-address-buyer",
        "used-assetlot",
        "touchpoint-email-financing",
        "organisation-email-ted-esen",
        "organisation-contact-point-paying",
        "touchpoint-city-tender-eval-lot",
        "organisation-contact-point-tender-eval-part",
        "organisation-city-employ-legis-part",
        "touchpoint-contact-point-tender-receip-lot",
        "BT-01(d)-procedure",
        "concession-revenue-cur-buyer",
        "BT-78-Lot",
        "organisation-partname-employ-legis-part",
        "dps-termination-lot",
        "organisation-street-employ-legis-part",
        "touchpoint-city-tender-receip-part",
        "touchpoint-gateway-environ-legis-lot",
        "organisation-email-fiscal-legis-lot",
        "reserved-procurement-lot",
        "estimated-value-part",
        "touchpoint-tel-environ-legis-part",
        "touchpoint-contact-point-financing",
        "internal-identifier-proc",
        "organisation-contact-point-reviewinfo-lot",
        "organisation-internet-address-employ-legis-part",
        "organisation-partname-paying",
        "BT-540-Lot",
        "contract-nature-main-lot",
        "BT-75-Lot",
        "subcontracting-obligation-maximum-lot",
        "organisation-city-addinfo-lot",
        "buyer-touchpoint-country",
        "BT-40-Lot",
        "document-official-language-part",
        "OPP-070-notice",
        "touchpoint-street-revieworg-lot",
        "touchpoint-post-code-paying",
        "touchpoint-post-code-ted-esen",
        "framework-duration-justification-lot",
        "organisation-country-environ-legis-lot",
        "organisation-post-code-docprovider-lot",
        "touchpoint-post-code-signatory",
        "touchpoint-fax-tender-eval-lot",
        "following-contract-lot",
        "organisation-city-tender-eval-part",
        "organisation-name-fiscal-legis-lot",
        "organisation-partname-environ-legis-part",
        "organisation-contact-point-tender-receip-part",
        "change-notice-version-identifier",
        "guarantee-required-lot",
        "touchpoint-post-code-financing",
        "activity-sector",
        "document-restricted-url-part",
        "organisation-country-sub-revieworg-part",
        "organisation-partname-mediator-lot",
        "touchpoint-country-addinfo-part",
        "BT-130-Lot",
        "announcement-url",
        "notice-type",
        "OPP-110-Business",
        "organisation-gateway-mediator-lot",
        "touchpoint-contact-point-subcontractor",
        "touchpoint-tel-mediator-part",
        "organisation-street-subcontractor",
        "touchpoint-internet-address-employ-legis-part",
        "modification-previous-notice-section-identifier",
        "touchpoint-country-sub-mediator-part",
        "organisation-person-reviewinfo-lot",
        "touchpoint-email-revieworg-part",
        "organisation-person-addinfo-lot",
        "SUB_LG",
        "place-of-performance-add-proc",
        "touchpoint-street-mediator-part",
        "buyer-city",
        "participant-name-lot",
        "buyer-touchpoint-name",
        "BT-1501(s)-Contract",
        "organisation-country-revieworg-part",
        "public-opening-description-lot",
        "OPP-010-notice",
        "missing-info-submission-lot",
        "organisation-street-signatory",
        "touchpoint-city-fiscal-legis-part",
        "BT-754-Lot",
        "BT-09(a)-Procedure",
        "organisation-name-ted-esen",
        "BT-748-Lot",
        "BT-746-Organization",
        "BT-115-Part",
        "organisation-post-code-buyer",
        "social-objective-lot",
        "organisation-identifier-tender-eval-lot",
        "touchpoint-contact-point-serv-prov",
        "touchpoint-fax-docprovider-lot",
        "tender-identifier",
        "place-of-performance-subdiv-proc",
        "touchpoint-name-financing",
        "BT-201-Contract",
        "organisation-city-tender-eval-lot",
        "tender-validity-deadline-lot",
        "touchpoint-email-tenderer",
        "publication-number",
        "touchpoint-email-mediator-lot",
        "touchpoint-name-reviewinfo-part",
        "contract-nature-subtype",
        "BT-119-LotResult",
        "organisation-country-fiscal-legis-part",
        "organisation-country-tender-eval-lot",
        "touchpoint-country-sub-tender-eval-lot",
        "tender-value-cur-lowest",
        "touchpoint-name-employ-legis-lot",
        "BT-22-Procedure",
        "organisation-name-subcontractor",
        "organisation-internet-address-signatory",
        "organisation-country-addinfo-lot",
        "winner-decision-date",
        "organisation-fax-docprovider-part",
        "BT-553-Tender",
        "OPP-120-Business",
        "BT-755-Lot",
        "buyer-review-compainants-val",
        "change-procurement-documents-date",
        "touchpoint-partname-employ-legis-part",
        "touchpoint-country-sub-employ-legis-lot",
        "organisation-email-tender-receip-lot",
        "prize-rank-lot",
        "BT-22-Part",
        "place-of-performance-city-proc",
        "touchpoint-gateway-tenderer",
        "dispatch-invitation-interest-lot",
        "buyer-touchpoint-email",
        "organisation-contact-point-environ-legis-lot",
        "BT-706-UBO",
        "organisation-name-fiscal-legis-part",
        "ubo-tel",
        "organisation-gateway-tender-receip-lot",
        "BT-131(d)-Lot",
        "organisation-identifier-employ-legis-part",
        "touchpoint-post-code-reviewinfo-part",
        "organisation-internet-address-reviewinfo-part",
        "touchpoint-country-employ-legis-part",
        "description-proc",
        "touchpoint-post-code-addinfo-part",
        "organisation-name-tender-eval-lot",
        "touchpoint-email-employ-legis-part",
        "organisation-tel-addinfo-lot",
        "TVH",
        "organisation-tel-revieworg-lot",
        "TVL",
        "touchpoint-partname-signatory",
        "touchpoint-contact-point-employ-legis-part",
        "selection-criterion-lot",
        "organisation-country-subcontractor",
        "deadline-time-lot",
        "touchpoint-post-code-fiscal-legis-part",
        "touchpoint-email-employ-legis-lot",
        "selection-criteria-second-stage-invite-number-threshold-lot",
        "place-of-performance-subdiv-part",
        "touchpoint-fax-signatory",
        "BT-731-Tender",
        "touchpoint-contact-point-environ-legis-lot",
        "BT-1311(d)-Lot",
        "organisation-post-code-employ-legis-part",
        "organisation-tel-financing",
        "touchpoint-city-environ-legis-part",
        "BT-631-Lot",
        "main-classification-part",
        "dispatch-date",
        "OPP-112-Business",
        "electronic-auction-lot",
        "contact-nature-main-part",
        "strategic-procurement-lot",
        "organisation-identifier-ted-esen",
        "BT-712(a)-LotResult",
        "received-submissions-type-val",
        "touchpoint-internet-address-tenderer",
        "eu-funds-identifier",
        "contract-title",
        "BT-5121-Part",
        "business-street",
        "tender-value-lowest",
        "touchpoint-country-sub-ted-esen",
        "touchpoint-contact-point-mediator-part",
        "touchpoint-email-environ-legis-lot",
        "organisation-street-addinfo-part",
        "touchpoint-gateway-mediator-part",
        "buyer-internet-address",
        "winner-internet-address",
        "OPP-031-Tender",
        "notice-title",
        "tender-lot-identifier",
        "BT-162-Tender",
        "BT-41-Lot",
        "organisation-email-buyer",
        "touchpoint-tel-tender-eval-lot",
        "BT-300-LotsGroup",
        "organisation-email-docprovider-part",
        "organisation-country-mediator-lot",
        "organisation-person-docprovider-part",
        "touchpoint-country-sub-signatory",
        "BT-728-Lot",
        "organisation-post-code-environ-legis-lot",
        "buyer-partname",
        "organisation-country-sub-tender-receip-lot",
        "concession-revenue-user",
        "BT-743-Lot",
        "BT-734-LotsGroup",
        "BT-555-Tender",
        "BT-720-Tender",
        "touchpoint-country-addinfo-lot",
        "previous-planning-identifier-part-part",
        "touchpoint-gateway-revieworg-lot",
        "deadline-date-part",
        "organisation-street-buyer",
        "award-criterion-number-threshold-glo",
        "contract-conditions-description-lot",
        "BT-36-Part",
        "BT-115-Lot",
        "BT-702-notice",
        "organisation-country-sub-tender-receip-part",
        "BT-17-Lot",
        "BT-721-Contract",
        "OPT-072-Lot",
        "organisation-tel-fiscal-legis-part",
        "BT-615-Lot",
        "organisation-post-code-reviewinfo-lot",
        "organisation-partname-tenderer",
        "reward-other-lot",
        "main-activity",
        "contract-url",
        "organisation-fax-financing",
        "touchpoint-gateway-serv-prov",
        "touchpoint-tel-ted-esen",
        "publication-name",
        "touchpoint-tel-environ-legis-lot",
        "organisation-country-tender-receip-part",
        "BT-775-Lot",
        "organisation-email-serv-prov",
        "organisation-tel-tenderer",
        "place-of-performance-addtional-lot",
        "organisation-gateway-tender-receip-part",
        "contract-nature",
        "touchpoint-tel-addinfo-lot",
        "organisation-country-sub-tender-eval-part",
        "organisation-name-environ-legis-part",
        "lot-included-proc",
        "buyer-identifier",
        "organisation-tel-subcontractor",
        "BT-774-Lot",
        "legal-basis-notice",
        "organisation-street-docprovider-part",
        "BT-5141-Part",
        "touchpoint-city-ted-esen",
        "touchpoint-country-sub-environ-legis-lot",
        "touchpoint-name-addinfo-part",
        "notice-subtype",
        "organisation-fax-ted-esen",
        "touchpoint-post-code-subcontractor",
        "notice-identifier",
        "organisation-tel-fiscal-legis-lot",
        "BT-18-Lot",
        "touchpoint-name-reviewinfo-lot",
        "OPP-100-Business",
        "value-prize-cur-lot",
        "BT-156-NoticeResult",
        "touchpoint-post-code-tender-eval-lot",
        "registration-place-country",
        "organisation-internet-address-tender-eval-part",
        "winner-city",
        "BT-42-Lot",
        "document-url-part",
        "organisation-country-sub-fiscal-legis-lot",
        "country-origin",
        "touchpoint-country-buyer",
        "organisation-internet-address-financing",
        "business-name",
        "BT-330-Procedure",
        "organisation-email-revieworg-part",
        "touchpoint-tel-serv-prov",
        "organisation-city-fiscal-legis-lot",
        "organisation-gateway-reviewinfo-part",
        "legal-basis-proc",
        "touchpoint-partname-subcontractor",
        "buyer-name",
        "modification-reason-description",
        "BT-262-Part",
        "BT-740-Procedure-Buyer",
        "organisation-fax-tender-receip-part",
        "BT-131(t)-Lot",
        "touchpoint-gateway-addinfo-lot",
        "touchpoint-contact-point-ted-esen",
        "BT-763-Procedure",
        "organisation-email-addinfo-lot",
        "organisation-post-code-employ-legis-lot",
        "award-criterion-complicated-lot",
        "total-value",
        "touchpoint-name-mediator-lot",
        "touchpoint-partname-paying",
        "touchpoint-country-sub-reviewinfo-part",
        "document-url-lot",
        "touchpoint-tel-reviewinfo-lot",
        "BT-151-Contract",
        "touchpoint-partname-docprovider-part",
        "organisation-country-sub-environ-legis-lot",
        "organisation-post-code-tender-receip-lot",
        "organisation-gateway-reviewinfo-lot",
        "received-submissions-type-code",
        "BT-711-LotResult",
        "subcontracting-value",
        "touchpoint-street-tenderer",
        "BT-729-Lot",
        "winner-touchpoint-name",
        "organisation-gateway-fiscal-legis-part",
        "organisation-fax-tender-receip-lot",
        "organisation-email-financing",
        "OPT-071-Lot",
        "BT-57-Lot",
        "touchpoint-country-docprovider-part",
        "touchpoint-gateway-signatory",
        "successive-redution-lot",
        "organisation-internet-address-environ-legis-part",
        "touchpoint-partname-revieworg-lot",
        "buyer-touchpoint-internet-address",
        "organisation-name-tenderer",
        "organisation-fax-reviewinfo-lot",
        "value-prize-lot",
        "organisation-partname-environ-legis-lot",
        "organisation-country-tender-receip-lot",
        "BT-541-Lot",
        "title-lot",
        "ubo-post-code",
        "BT-144-LotResult",
        "organisation-city-environ-legis-lot",
        "contract-duration-period-oth-lot",
        "additional-info-glo",
        "organisation-identifier-reviewinfo-part",
        "BT-124-Part",
        "touchpoint-email-addinfo-part",
        "touchpoint-fax-subcontractor",
        "framework-buyer-categories-lot",
        "organisation-tel-tender-eval-part",
        "touchpoint-email-reviewinfo-part",
        "touchpoint-internet-address-environ-legis-part",
        "BT-1251-Part",
        "award-criterion-number-lot",
        "organisation-fax-addinfo-part",
        "touchpoint-fax-employ-legis-lot",
        "BT-165-Organization-Company",
        "organisation-gateway-tenderer",
        "touchpoint-gateway-revieworg-part",
        "touchpoint-country-financing",
        "deadline-receipt-request-date-lot",
        "touchpoint-fax-revieworg-lot",
        "buyer-contact-point",
        "term-performance-lot",
        "BT-300-Lot",
        "touchpoint-post-code-docprovider-part",
        "touchpoint-tel-docprovider-lot",
        "organisation-internet-address-serv-prov",
        "touchpoint-post-code-environ-legis-part",
        "organisation-tel-reviewinfo-part",
        "exclusion-grounds-description",
        "framework-estimated-value-cur",
        "BT-773-Tender",
        "touchpoint-fax-reviewinfo-lot",
        "BT-630(d)-Lot",
        "touchpoint-post-code-docprovider-lot",
        "organisation-street-employ-legis-lot",
        "touchpoint-country-sub-buyer",
        "BT-760-LotResult",
        "cross-border-law-description-proc",
        "touchpoint-city-revieworg-part",
        "touchpoint-name-tender-receip-part",
        "environmental-impact-lot",
        "BT-23-Part",
        "touchpoint-contact-point-reviewinfo-lot",
        "touchpoint-partname-tender-receip-lot",
        "organisation-partname-reviewinfo-lot",
        "OPP-022-Contract",
        "winner-touchpoint-city",
        "organisation-city-ted-esen",
        "BT-71-Lot",
        "BT-1451-Contract",
        "BT-300-procedure",
        "organisation-tel-serv-prov",
        "selection-criteria-second-stage-invite-number-weight-lot",
        "contract-duration-start-date-lot",
        "organisation-city-mediator-lot",
        "organisation-tel-tender-receip-part",
        "organisation-city-reviewinfo-part",
        "organisation-person-paying",
        "BT-200-Contract",
        "organisation-email-tender-eval-lot",
        "result-lot-identifier",
        "BT-745-Lot",
        "organisation-contact-point-revieworg-lot",
        "BT-7531-Lot",
        "estimated-value-cur-glo",
        "entity-main-activity",
        "organisation-post-code-paying",
        "touchpoint-tel-docprovider-part",
        "organisation-street-serv-prov",
        "organisation-gateway-docprovider-lot",
        "BT-13(t)-Lot",
        "concession-revenue-cur-user",
        "organisation-person-mediator-part",
        "touchpoint-name-addinfo-lot",
        "organisation-fax-signatory",
        "electronic-ordering-lot",
        "touchpoint-partname-mediator-part",
        "touchpoint-partname-ted-esen",
        "total-value-cur",
        "organisation-internet-address-fiscal-legis-part",
        "organisation-partname-fiscal-legis-lot",
        "contract-duration-period-part",
        "document-restricted-justification-part",
        "touchpoint-name-tenderer",
        "organisation-partname-buyer",
        "touchpoint-fax-revieworg-part",
        "winner-touchpoint-email",
        "electronic-payment-lot",
        "organisation-contact-point-addinfo-lot",
        "organisation-partname-mediator-part",
        "deadline-receipt-tender-time-lot",
        "touchpoint-post-code-revieworg-lot",
        "BT-113-Lot",
        "BT-5011-Contract",
        "business-internet-address",
        "BT-58-Lot",
        "touchpoint-tel-revieworg-part",
        "touchpoint-fax-serv-prov",
        "BT-765-Part",
        "BT-15-Lot",
        "document-unofficial-language-part",
        "touchpoint-country-revieworg-part",
        "touchpoint-street-mediator-lot",
        "touchpoint-partname-buyer",
        "award-criterion-description-lot",
        "touchpoint-city-employ-legis-part",
        "touchpoint-country-sub-tender-receip-lot",
        "main-classification-proc",
        "internal-identifier-lot",
        "buyer-reviewrequests-irregularity-type-val",
        "BT-531-Procedure",
        "touchpoint-fax-fiscal-legis-part",
        "organisation-email-docprovider-lot",
        "organisation-tel-reviewinfo-lot",
        "touchpoint-internet-address-financing",
        "organisation-country-sub-tenderer",
        "BT-44-Lot",
        "document-unofficial-language-lot",
        "touchpoint-contact-point-employ-legis-lot",
        "organisation-post-code-addinfo-part",
        "winner-listed",
        "winner-selection-status",
        "organisation-city-subcontractor",
        "BT-1251-Lot",
        "BT-543-Lot",
        "organisation-city-paying",
        "public-opening-time-lot",
        "winner-partname",
        "BT-772-Lot",
        "BT-718-notice",
        "organisation-email-tender-receip-part",
        "touchpoint-internet-address-fiscal-legis-part",
        "direct-award-justification-text-proc",
        "BT-644-Lot",
        "organisation-identifier-fiscal-legis-lot",
        "touchpoint-fax-mediator-part",
        "touchpoint-gateway-tender-receip-part",
        "touchpoint-contact-point-revieworg-part",
        "group-framework-value-notice",
        "organisation-city-revieworg-lot",
        "organisation-partname-tender-eval-part",
        "BT-5071-Lot",
        "touchpoint-street-reviewinfo-lot",
        "organisation-contact-point-ted-esen",
        "framework-value-notice",
        "BT-262-Procedure",
        "form-type",
        "organisation-person-subcontractor",
        "review-deadline-description-lot",
        "BT-7532-Lot",
        "organisation-street-environ-legis-lot",
        "organisation-country-sub-addinfo-part",
        "touchpoint-country-fiscal-legis-part",
        "organisation-person-revieworg-lot",
        "touchpoint-post-code-mediator-lot",
        "organisation-gateway-addinfo-part",
        "organisation-identifier-fiscal-legis-part",
        "touchpoint-gateway-financing",
        "organisation-name-docprovider-lot",
        "touchpoint-name-tender-receip-lot",
        "touchpoint-country-sub-environ-legis-part",
        "BT-263-Procedure",
        "organisation-gateway-buyer",
        "BT-04-notice",
        "touchpoint-country-sub-docprovider-part",
        "organisation-street-environ-legis-part",
        "touchpoint-email-mediator-part",
        "organisation-partname-revieworg-lot",
        "touchpoint-country-sub-addinfo-lot",
        "touchpoint-fax-reviewinfo-part",
        "BT-142-LotResult",
        "organisation-identifier-tender-eval-part",
        "touchpoint-email-docprovider-part",
        "touchpoint-contact-point-environ-legis-part",
        "BT-536-Part",
        "BT-13714-Tender",
        "organisation-contact-point-subcontractor",
        "award-criteria-complicated-glo",
        "touchpoint-gateway-reviewinfo-lot",
        "organisation-partname-subcontractor",
        "touchpoint-name-docprovider-part",
        "touchpoint-post-code-buyer",
        "touchpoint-partname-environ-legis-part",
        "BT-300-Part",
        "touchpoint-internet-address-serv-prov",
        "result-value-cur-lot",
        "BT-67(a)-Procedure",
        "touchpoint-fax-financing",
        "organisation-country-employ-legis-lot",
        "organisation-person-ted-esen",
        "touchpoint-post-code-mediator-part",
        "organisation-gateway-tender-eval-lot",
        "winner-name",
        "business-country",
        "BT-744-Lot",
      ],
      limit: "6",
      scope: "ALL",
      checkQuerySyntax: false,
      page: count,
      paginationMode: "PAGE_NUMBER",
    }),
  })
    .then(async (response) => await response.json())
    .then((res) => {
      loopCount = res.totalNoticeCount;
      return res;
    });
};

// Remove all documents from the "ted" collection
const removeOldDocuments = async (loggerId: ObjectId): Promise<void> => {
  await updateProcessStatus({
    status: "Running",
    message: `Removing old documents from the collection`,
    loggerId,
  });
  await Ted.deleteMany({}).catch((error: Error) => {
    logError(loggerId, "Failed to remove old documents from the collection");
    console.error(error);
  });
};

const addTedFilesToCollection = async (
  jsonMap: Map<any, any>
): Promise<void> => {
  await Ted.bulkWrite(
    Array.from(jsonMap, ([name, value]) => ({
      updateOne: {
        filter: { publicationNumber: name },
        update: value,
        upsert: true,
      },
    }))
  );
};

let loopCount = 1;

const splitIntoMonthRanges = (startDate: Date, endDate: Date) => {
  const dateRanges = [];
  let currentDate = new Date(startDate);

  while (currentDate <= endDate) {
    const startOfMonth = new Date(
      currentDate.getFullYear(),
      currentDate.getMonth(),
      1
    );
    const endOfMonth = new Date(
      currentDate.getFullYear(),
      currentDate.getMonth() + 1,
      0
    );

    const startDateInRange = new Date(
      Math.max(startOfMonth.getTime(), currentDate.getTime())
    );
    const endDateInRange = new Date(
      Math.min(endOfMonth.getTime(), endDate.getTime())
    );

    dateRanges.push([startDateInRange, endDateInRange]);

    currentDate.setMonth(currentDate.getMonth() + 1);
    currentDate.setDate(1);
  }

  return dateRanges;
};

const isDate = (val: any): boolean => !isNaN(new Date(val).getTime());

const yyyymmdd = (date?: Date): string => {
  const now = isDate(date) && date !== undefined ? date : new Date();
  const y = now.getFullYear();
  const m = now.getMonth() + 1;
  const d = now.getDate();
  return "" + y + (m < 10 ? "0" : "") + m + (d < 10 ? "0" : "") + d;
};

export const syncTedTimeFrame = async (
  startDate: string,
  loggerId: ObjectId,
  endDate?: string,
  shouldReset: boolean = false
): Promise<Date[][]> => {
  // Set process status to idle
  await updateProcessStatus({
    status: "Running",
    message: "Starting sync process",
    loggerId,
  });

  const result = splitIntoMonthRanges(
    new Date(startDate),
    endDate != null ? new Date(endDate) : new Date()
  );

  // Remove all documents from the "ted" collection
  if (shouldReset) {
    await removeOldDocuments(loggerId);
  }

  await createTedMeta().catch((error: Error) => {
    logError(loggerId, "Failed to create ted meta data");
    console.error(error);
  });

  let dateCount = 1;
  for (const range of result) {
    const [startDate, endDate] = range;

    for (let count = 1; count <= loopCount; count++) {
      const jsonMap = new Map();

      const response = await getData(
        count,
        yyyymmdd(startDate),
        yyyymmdd(endDate)
      );

      if (response.notices === undefined || response.notices.length === 0) {
        // console.log("Finished Fetching", response);
        break;
      }

      response.notices.forEach((notice: any) => {
        if (notice["publication-number"]) {
          jsonMap.set(notice["publication-number"], notice);
        }
      });

      await addTedFilesToCollection(jsonMap);

      await updateProcessStatus({
        status: "Running",
        message: `Processing entry ${count * 6} of ${loopCount} for month ${dateCount} of ${result.length}`,
        loggerId,
      });
    }
    dateCount++;
  }

  loopCount = 1;

  // Set process status to idle
  await updateProcessStatus({
    status: "Idle",
    message: "-",
    loggerId,
  });

  await logTedSuccess(loggerId);

  return result;
};

let processStatus = {
  status: "Idle",
  message: "-",
};

// Update process status
const updateProcessStatus = async (status: {
  status: string;
  message: string;
  loggerId: ObjectId;
}): Promise<void> => {
  await logUpdate(status.loggerId, status.message);
  processStatus = status;
};

export const getTedProcessStatus = (): {
  status: string;
  message: string;
} => processStatus;
